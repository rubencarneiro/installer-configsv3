{"$schema":"http://json-schema.org/draft-07/schema#","$id":"v3/schema/device.schema.yml","title":"Device","description":"Device configuration for the UBports Installer","type":"object","properties":{"name":{"title":"Name","type":"string","description":"The human-readable name under which the device was marketed. This includes the name of the manufacturer if it makes sense. I.e. you would not refer to the 'Oneplus One' as 'One', but you would not call the 'iPhone 9' 'Apple iPhone 9'. Use common sense."},"codename":{"title":"Codename","type":"string","description":"A short codename that is used internally to identify the device. This (with the extension '.yml') should also be the filename. If there are multiple codenames in use for the exact same device, only create a single one with the most prominent one and add the correct aliases to aliases.json."},"formfactor":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"formfactor.schema.yml","title":"Formfactor","type":"string","description":"What kind of device is it?","enum":["computer","laptop","phone","tablet","watch"]},"aliases":{"title":"Aliases","type":"array","description":"Alternative codenames this device might be identified as.","uniqueItems":true,"items":{"type":"string"}},"doppelgangers":{"title":"Doppelgangers","type":"array","description":"Codenames of devices this device should not be confused with.","uniqueItems":true,"items":{"type":"string"}},"user_actions":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"user_actions.schema.yml","title":"User actions","type":"object","description":"Object that contains instructions for the user for later reference.","patternProperties":{"\\w":{"title":"User action","type":"object","description":"Instruction that can be referenced and presented to the user. Eg key combinations to reboot to recovery or bootloader.","ubports_no-unused-user_actions":null,"properties":{"title":{"title":"Title","type":"string","description":"Identifier of the step. Eg. 'Enable USB-debugging'"},"description":{"title":"Description","type":"string","description":"Short description of the step. For simple tasks, the full instructions can be put here."},"image":{"title":"Image","type":"string","description":"String referring to a picture in the installer.","enum":["phone_power_up","phone_power_down"]},"button":{"title":"Button","type":"boolean","description":"Specify whether there should be a done-button displayed."},"link":{"title":"Link","type":"string","description":"A link to a more extensive tutorial."}},"required":["title","description"]}},"additionalProperties":false},"handlers":{"title":"Handlers","type":"object","description":"Steps to run to handle specific known errors","properties":{"bootloader_locked":{"title":"Handle a bootloader locked error","$ref":"#/properties/operating_systems/items/properties/steps/items"}},"additionalProperties":false},"unlock":{"title":"Unlock actions","type":"array","description":"An array of strings referring to user_actions defined above that are needed to unlock the device. This might include simple things like enabling adb access or bigger steps like using a leaked oem tool to flash highly questionable images that unlock the bootloader. Whatever is needed to make installations possible.","uniqueItems":true,"items":{"type":"string"}},"operating_systems":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"operating_systems.schema.yml","title":"Operating systems","type":"array","description":"An array of objects describing operating systems available for installation.","uniqueItems":true,"items":{"title":"Operating system","type":"object","description":"An operating system available for installation","required":["name","compatible_installer","prerequisites","steps"],"properties":{"name":{"title":"OS name","type":"string","description":"Human-readable name of the operating system."},"codename":{"title":"Codename of the device","type":"string","description":"Codename of the device as used by the operating system."},"compatible_installer":{"title":"Compatible Installer","type":"string","ubports_semver":null},"options":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"options.schema.yml","title":"Options","type":"array","description":"Options for the installation.","items":{"title":"Option","type":"object","description":"Option for the installation.","properties":{"var":{"type":"string","description":"Variable the setting will be stored in."},"name":{"type":"string","description":"Human-readable identifier of the setting."},"tooltip":{"type":"string","description":"A very short help text describing the setting."},"link":{"type":"string","description":"A link to the docs describing the setting."},"type":{"type":"string","description":"Describes what values are accepted by the setting and how they are provided.","enum":["checkbox","input","select"]},"remote_values":{"title":"Remote values","type":"object","description":"If the values can be generated from a remote source like the systemimage api, this provides the required information for that.","additionalProperties":false,"maxProperties":1,"properties":{"systemimage:channels":{"type":"null"},"asteroid_os:channels":{"type":"null"},"lineage_os:channels":{"type":"null"},"postmarketos:releases":{"type":"null"},"postmarketos:interfaces":{"type":"null"}}},"value":{"description":"Default value of the option"},"values":{"title":"Values","type":"array","description":"List of values for the select."}},"required":["var","name","type"]}},"prerequisites":{"title":"Prerequisites","type":"array","description":"An array of strings referring to user_actions defined above that are needed before the installation. This should not include the steps from the generic unlock block, but actions specific to the installation of this operating system.","items":{"type":"string","description":"Reference to user_action that's needed before the installation of this OS. Steps required for every OS should be put in the generic unlock block instead.","ubports_user-action":null,"ubports_not-in-unlock":null}},"steps":{"title":"Steps","type":"array","description":"An ordered array of objects describing steps required to install the operating system.","items":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"step.schema.yml","title":"Step","type":"object","description":"Installation step.","properties":{"actions":{"title":"group step","type":"array","items":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"action.schema.yml","title":"Action","type":"object","description":"Actions represent atomic tasks to be executed by different plugins of the UBports Installer. Plugins may interface with each other to reduce the amount of redundant code.","maxProperties":1,"minProperties":1,"additionalProperties":false,"properties":{"adb:shell":{"title":"adb:shell action","description":"Run a command on the device via adb shell","oneOf":[{"type":"array","items":{"type":"string","description":"Shell arguments"},"ubports_installer-compatibility":">=0.9.6-beta"},{"type":"object","required":["args"],"additionalProperties":false,"properties":{"args":{"title":"Arguments","type":"array","description":"Shell arguments","items":{"type":"string"}}},"ubports_installer-compatibility":">=0.9.2-beta <0.10.0-beta","deprecated":true}]},"adb:reboot":{"title":"adb:reboot action","description":"Reboot the device over adb.","type":"object","required":["to_state"],"additionalProperties":false,"properties":{"to_state":{"title":"To state","type":"string","description":"State to reboot to.","enum":["bootloader","download","edl","recovery","system","sideload","sideload-auto-reboot"]}}},"adb:format":{"title":"adb:format action","description":"Format a partition over adb shell.","type":"object","required":["partition"],"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string","description":"Partition to format."}}},"adb:sideload":{"title":"adb:sideload action","description":"Sideload a zip file OTA package.","type":"object","required":["file","group"],"additionalProperties":false,"properties":{"file":{"title":"Zip to sideload","type":"string"},"group":{"title":"Group","type":"string"}}},"adb:push":{"title":"adb:push action","description":"Push files to the device over adb.","type":"object","required":["files","group","dest"],"additionalProperties":false,"properties":{"files":{"title":"Files","description":"File names to push","type":"array","items":{"type":"string"}},"group":{"title":"Group","type":"string"},"dest":{"title":"Destination path","description":"Path on the device to push files to","type":"string"}}},"adb:preparesystemimage":{"title":"adb:preparesystemimage action","description":"Prepare for Ubuntu Touch system image installation.","type":"null"},"adb:assert_prop":{"title":"adb:assert_prop action","description":"Assert a property value over adb shell getprop or, failing that, reading from the default.prop file.","type":"object","additionalProperties":false,"minProperties":2,"maxProperties":2,"required":["prop"],"properties":{"prop":{"title":"Property","type":"string","description":"Property to assert using adb getprop"},"value":{"title":"Value","type":"string","description":"Asserted property value"},"regex":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"regex.schema.yml","title":"Regular Expression","type":"object","description":"RegEx Object","additionalProperties":false,"required":["pattern"],"properties":{"pattern":{"title":"RegEx Pattern","type":"string","description":"JS RegEx pattern to match"},"flags":{"title":"RegEx Flags","type":"string","enum":["i","g","s","m","y","u"],"description":"JS RegEx flags"}}}},"ubports_installer-compatibility":">=0.9.4-beta"},"asteroid_os:download":{"title":"asteroid_os:download action","description":"Download AsteroidOS images.","type":"null"},"core:download":{"title":"core:download action","description":"Download files.","type":"object","required":["group","files"],"additionalProperties":false,"properties":{"group":{"title":"Group","type":"string","description":"Files group"},"files":{"title":"Files","type":"array","description":"Files to download.","items":{"title":"File","type":"object","properties":{"url":{"type":"string","description":"URL of the file to download"},"name":{"type":"string","description":"Name to save the file under on disk"},"checksum":{"$ref":"#/properties/handlers/properties/bootloader_locked/properties/actions/items/properties/core%3Amanual_download/properties/file/properties/checksum"}},"required":["url"],"additionalProperties":false}}}},"core:write":{"title":"core:write action","description":"Write text to a file.","type":"object","required":["group","file","content"],"additionalProperties":false,"properties":{"group":{"title":"Group","type":"string"},"file":{"title":"File","type":"string"},"content":{"title":"Content","type":"string"}}},"core:unpack":{"title":"core:unpack action","description":"Unpack/decompress an archive using 7z.","type":"object","required":["group","files"],"additionalProperties":false,"properties":{"group":{"title":"Group","type":"string"},"files":{"type":"array","items":{"type":"object","required":["archive","dir"],"additionalProperties":false,"properties":{"archive":{"title":"Archive to decompress","type":"string"},"dir":{"title":"Target directory","type":"string"}}}}}},"core:manual_download":{"title":"core:manual_download action","description":"Instruct the user to manually download a file that can't be downloaded automatically, because it is behind some protective mechanism. The user will be instructed to load the file into the installer to continue the installation.","type":"object","required":["group","file"],"additionalProperties":false,"properties":{"group":{"title":"Group","type":"string","description":"Files group"},"file":{"title":"File","description":"File to download","type":"object","required":["name","url","checksum"],"additionalProperties":false,"properties":{"name":{"type":"string"},"url":{"type":"string","description":"URL of the file to download"},"checksum":{"$schema":"https://json-schema.org/draft/2020-12/schema","$id":"checksum.schema.yml","title":"Checksum","type":"object","description":"Verify a file's integrity by checking it with a hashing algorithm","properties":{"sum":{"title":"Hash","type":"string","description":"Checksum of the file to download"},"algorithm":{"title":"Hashing algorithm","type":"string","description":"Hashing algorithm to use to calculate the checksum","enum":["RSA-MD4","RSA-MD5","RSA-MDC2","RSA-RIPEMD160","RSA-SHA1","RSA-SHA1-2","RSA-SHA224","RSA-SHA256","RSA-SHA3-224","RSA-SHA3-256","RSA-SHA3-384","RSA-SHA3-512","RSA-SHA384","RSA-SHA512","RSA-SHA512/224","RSA-SHA512/256","RSA-SM3","blake2b512","blake2s256","id-rsassa-pkcs1-v1_5-with-sha3-224","id-rsassa-pkcs1-v1_5-with-sha3-256","id-rsassa-pkcs1-v1_5-with-sha3-384","id-rsassa-pkcs1-v1_5-with-sha3-512","md4","md4WithRSAEncryption","md5","md5-sha1","md5WithRSAEncryption","mdc2","mdc2WithRSA","ripemd","ripemd160","ripemd160WithRSA","rmd160","sha1","sha1WithRSAEncryption","sha224","sha224WithRSAEncryption","sha256","sha256WithRSAEncryption","sha3-224","sha3-256","sha3-384","sha3-512","sha384","sha384WithRSAEncryption","sha512","sha512-224","sha512-224WithRSAEncryption","sha512-256","sha512-256WithRSAEncryption","sha512WithRSAEncryption","shake128","shake256","sm3","sm3WithRSAEncryption","ssl3-md5","ssl3-sha1","whirlpool"]}}}}}}},"core:info":{"title":"core:info action","description":"Display information in the UI.","type":"object","additionalProperties":false,"minProperties":1,"properties":{"status":{"title":"Status message","type":"string","description":"Message displayed in the upper line of the footer"},"dots":{"title":"Dots (waiting animation)","type":"boolean","description":"Dots (waiting animation) in the upper line of the footer"},"info":{"title":"Info message","type":"string","description":"Message displayed in the lower line of the footer"},"progress":{"title":"Progress","type":"number","description":"Progress bar (omit to hide)","minimum":0,"maximum":1},"speed":{"title":"Speed","type":"number","description":"speed in MB/s (omit to hide)","minimum":0,"maximum":5000}}},"core:group":{"title":"core:group action","description":"Run steps as a group. Useful for applying the same conditional expression to a whole series of steps.","type":"array","items":{"$ref":"#/properties/operating_systems/items/properties/steps/items"}},"core:user_action":{"title":"core:user_action action","description":"Instruct the user to run a user_action.","type":"object","required":["action"],"additionalProperties":false,"properties":{"action":{"title":"User action","type":"string","description":"user action to run","ubports_user-action":null}}},"fastboot:oem_unlock":{"title":"fastboot:oem_unlock action","description":"OEM-unlock the device. Instruct the user to obtain and enter a code if necessary.","oneOf":[{"type":"null"},{"type":"object","required":["code_url"],"additionalProperties":false,"properties":{"code_url":{"title":"Code url","type":"string","description":"Website to obtain an unlock code"}}}]},"fastboot:flashing_unlock":{"title":"fastboot:flashing_unlock action","description":"Flashing-unlock the device.","type":"null"},"fastboot:reboot_bootloader":{"title":"fastboot:reboot_bootloader action","description":"Reboot the device to bootloader over fastboot.","type":"null"},"fastboot:reboot_fastboot":{"title":"fastboot:reboot_fastboot action","description":"Reboot the device to fastboot over fastboot.","type":"null","ubports_installer-compatibility":">=0.9.2-beta"},"fastboot:reboot_recovery":{"title":"fastboot:reboot_recovery action","description":"Reboot the device to recovery over fastboot.","type":"null"},"fastboot:update":{"title":"fastboot:update action","description":"Apply fastboot update zip.","type":"object","required":["group","file"],"additionalProperties":false,"properties":{"file":{"title":"File","type":"string"},"group":{"title":"Group","type":"string"}}},"fastboot:boot":{"title":"fastboot:boot action","description":"Boot an image file over fastboot.","type":"object","required":["group","file"],"additionalProperties":false,"properties":{"file":{"title":"File","type":"string"},"group":{"title":"Group","type":"string"}}},"fastboot:reboot":{"title":"fastboot:reboot action","description":"Reboot over fastboot.","type":"null"},"fastboot:continue":{"title":"fastboot:continue action","description":"Continue fastboot booting.","type":"null"},"fastboot:erase":{"title":"fastboot:erase action","description":"Erase a partition over fastboot.","type":"object","required":["partition"],"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string","description":"Partition to erase."}}},"fastboot:format":{"title":"fastboot:format action","description":"Format a partition over fasboot.","type":"object","required":["partition"],"dependentRequired":{"size":["type"]},"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string","description":"Partition to format."},"type":{"title":"Partition type","type":"string","description":"Partition type to use","enum":["ext2","ext4","f2fs"]},"size":{"title":"Partition size","type":"number","description":"Partition size"}}},"fastboot:flash":{"title":"fastboot:flash action","description":"Flash a partition over fastboot.","type":"object","required":["partitions"],"additionalProperties":false,"properties":{"partitions":{"title":"Partitions","type":"array","description":"Partitions to flash","items":{"title":"Partition to flash","type":"object","required":["partition","file","group"],"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string"},"file":{"title":"File","type":"string"},"group":{"title":"Group","type":"string"},"raw":{"title":"Raw","type":"boolean","default":false},"flags":{"title":"Flags","type":"array","items":{"type":"string"}}}}}}},"fastboot:create_logical_partition":{"title":"fastboot:create_logical_partition action","description":"Create a logical partition with the given name and size, in the super partition.","type":"object","required":["partition","size"],"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string"},"size":{"title":"Partition size","type":"number"}}},"fastboot:delete_logical_partition":{"title":"fastboot:delete_logical_partition action","description":"Delete a logical partition with the given name.","type":"object","required":["partition"],"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string"}}},"fastboot:resize_logical_partition":{"title":"fastboot:resize_logical_partition action","description":"Resize a logical partition with the given name and final size, in the super partition.","type":"object","required":["partition","size"],"additionalProperties":false,"properties":{"partition":{"title":"Partition","type":"string"},"size":{"title":"Partition size","type":"number"}}},"fastboot:wipe_super":{"title":"fastboot:wipe_super action","description":"Wipe super partition using fastboot.","type":"object","required":["image"],"additionalProperties":false,"properties":{"image":{"title":"Image","type":"object","required":["file","group"],"additionalProperties":false,"properties":{"file":{"title":"File","type":"string"},"group":{"title":"Group","type":"string"}}}}},"fastboot:set_active":{"title":"fastboot:set_active action","description":"Set active fastboot slot.","type":"object","required":["slot"],"additionalProperties":false,"properties":{"slot":{"title":"Bootloader slot","type":"string","enum":["a","b"]}}},"fastboot:assert_var":{"title":"fastboot:assert_var","description":"Assert a bootloader variable over fastboot getvar.","type":"object","additionalProperties":false,"minProperties":2,"maxProperties":2,"required":["variable"],"properties":{"variable":{"title":"Variable","type":"string","description":"Variable to assert using fastboot getvar"},"value":{"title":"Value","type":"string","description":"Asserted variable value"},"regex":{"$ref":"#/properties/handlers/properties/bootloader_locked/properties/actions/items/properties/adb%3Aassert_prop/properties/regex"}}},"fastboot:wait":{"title":"fastboot:wait action","description":"Wait until device becomes available over fastboot.","type":"null"},"heimdall:flash":{"title":"heimdall:flash action","description":"Flash partitions using heimdall.","type":"object","required":["partitions"],"additionalProperties":false,"properties":{"partitions":{"title":"Partitions","type":"array","description":"Partitions to flash","items":{"title":"Partition","type":"object","description":"Partition to flash","properties":{"partition":{"title":"Partition","type":"string"},"file":{"title":"File","type":"string"},"group":{"title":"Group","type":"string"}}}}}},"lineage_os:download":{"title":"lineage_os:download action","description":"Download LineageOS image files.","type":"null"},"lineage_os:install":{"title":"lineage_os:install action","description":"Install LineageOS images.","type":"null"},"postmarketos:download":{"title":"postmarketos:download action","description":"Download postmarketOS image files.","type":"null"},"systemimage:install":{"title":"systemimage:install action","description":"Download and install systemimage.","oneOf":[{"type":"object","ubports_installer-compatibility":">=0.9.4-beta","additionalProperties":false,"properties":{"verify_recovery":{"title":"Verify Recovery","type":"boolean","description":"Verify that the recovery is capable of installing Ubuntu Touch by asserting that `adb getprop ro.ubuntu.recovery`. Defaults to false."}}},{"type":"null","ubports_installer-compatibility":">=0.9.2-beta"}]}}}},"fallback":{"title":"Fallback steps","type":"array","items":{"$ref":"#/properties/handlers/properties/bootloader_locked/properties/actions/items"}},"optional":{"type":"boolean","description":"If true, errors in this step will be ignored"},"condition":{"title":"Condition","description":"Query an installation option to determine if the step should be run","$ref":"#/properties/handlers/properties/bootloader_locked/properties/actions/items/properties/core%3Agroup/items/properties/condition/oneOf/1/properties/OR/items"}},"additionalProperties":false}},"eula":{"title":"EULA","type":"object","description":"An end-user license agreement"},"slideshow":{"title":"Slideshow","type":"array","description":"An array of slides presenting the operating system's most compelling features.","items":{"title":"Slide","type":"object","description":"Slide about the operating system","properties":{"title":{"title":"Slide title","type":"string","description":"Title of the slide"},"text":{"title":"Slide text","type":"string","description":"Text body of the slide, Markdown supported here."},"image":{"title":"Slide image","type":"string","description":"Image displayed on the slide."}}}},"video":{"type":"string","description":"A video introducing the user to the operating system they just installed."},"donate":{"type":"string","description":"A link to donate to the developer of the operating system."},"get_involved":{"type":"string","description":"A link to the OSs get involved page."}},"additionalProperties":false}}},"required":["name","codename","operating_systems","formfactor"],"additionalProperties":false}